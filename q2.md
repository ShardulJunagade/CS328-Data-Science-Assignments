# Email Network Analysis Using Adjacency Matrices

This notebook analyzes the email-Eu-core network dataset using a pure adjacency matrix approach without relying on NetworkX. We'll treat the email network as an undirected graph and analyze the community structure based on department affiliations.

## Mathematical Framework

### Adjacency Matrix Representation

For an undirected graph with $n$ nodes, the adjacency matrix $A$ is an $n \times n$ symmetric matrix where:

$$A_{ij} = \begin{cases}
1 & \text{if nodes } i \text{ and } j \text{ are connected by an edge} \\
0 & \text{otherwise}
\end{cases}$$

The degree of node $i$ can be calculated as the sum of row $i$ in the adjacency matrix:

$$d_i = \sum_{j=1}^{n} A_{ij}$$

### Density Calculation

For a set of nodes $S$ representing a department, the density is defined as:

$$\text{density}(S) = \frac{\sum_{i,j \in S} A_{ij}}{|S| \cdot (|S| - 1)}$$

This represents the fraction of possible connections that actually exist within the department.

### Conductance Calculation

The conductance of a set $S$ measures how well-connected $S$ is to the rest of the graph relative to its internal connections:

$$\phi(S) = \frac{|\{(i,j) \in E : i \in S, j \not\in S\}|}{\min(\text{vol}(S), \text{vol}(V \setminus S))}$$

Where $\text{vol}(S) = \sum_{i \in S} d_i$ is the sum of degrees of nodes in $S$.

In matrix form, the numerator (cut size) can be calculated as:

$$|\{(i,j) \in E : i \in S, j \not\in S\}| = \sum_{i \in S} \sum_{j \not\in S} A_{ij}$$

### Normalized Laplacian

The normalized Laplacian matrix is defined as:

$$\mathcal{L}_{\text{norm}} = I - D^{-1/2}AD^{-1/2}$$

Where:
- $I$ is the identity matrix
- $A$ is the adjacency matrix
- $D$ is the diagonal degree matrix with $D_{ii} = d_i$

### Spectral Partitioning

The second eigenvector (Fiedler vector) of the normalized Laplacian provides an approximation to the optimal conductance cut. If we denote this eigenvector as $v_2$, then:

1. Sort the nodes according to their corresponding values in $v_2$
2. For each prefix of this sorted list, compute the conductance of the corresponding cut
3. The cut with the smallest conductance approximates the sparsest cut

## Implementation Details

### Loading the Network

Instead of using NetworkX, we directly construct a sparse adjacency matrix from the edge list:

1. Read the edge file and create a list of edges
2. Map original node IDs to consecutive indices (0 to n-1)
3. Construct a symmetric adjacency matrix for the undirected graph
4. Load department labels and map them to node indices

### Department Metrics Calculation

For each department:

1. Create a boolean mask for nodes in the department
2. Extract the submatrix corresponding to the department
3. Calculate density using the number of edges within the department
4. Calculate conductance by counting edges crossing the boundary

### Finding the Sparsest Cut

1. Compute the normalized Laplacian matrix
2. Find the second smallest eigenvalue and its corresponding eigenvector
3. Sort nodes based on their values in the eigenvector
4. Test different cuts and find the one with minimum conductance

### Analyzing Department Distribution

We analyze how departments are distributed across the sparsest cut:

1. Count the number of nodes from each department in both partitions
2. Visualize the distribution as a histogram
3. Plot the Fiedler vector values with departments color-coded

## Results Interpretation

The sparsest cut divides the email network into two partitions that minimize the conductance. This represents the most natural division of the research institution based on communication patterns.

The department histogram shows which departments tend to be grouped together and which are split by the spectral partitioning. Departments that remain mostly within one partition have stronger internal communication, while those split across partitions might have interdisciplinary connections.

The conductance value of the sparsest cut quantifies how well-separated the two communities are. A lower conductance indicates a more natural division in the network structure.